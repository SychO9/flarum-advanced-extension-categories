(()=>{var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{extend:()=>A});const n=flarum.reg.get("core","admin/app");var a=e.n(n);const o=flarum.reg.get("core","common/extend"),s=flarum.reg.get("core","admin/components/AdminNav");var r=e.n(s);const i=flarum.reg.get("core","admin/components/ExtensionLinkButton");var c=e.n(i);const l=flarum.reg.get("core","admin/components/ExtensionsWidget");var d=e.n(l);const g=flarum.reg.get("core","admin/components/LoadingModal");var u=e.n(g);const f=flarum.reg.get("core","common/utils/ItemList");var y=e.n(f);const p=flarum.reg.get("core","common/components/Dropdown");var h=e.n(p);const v=flarum.reg.get("core","common/components/Button");var x=e.n(v);const b=flarum.reg.get("core","common/components/Icon");var E=e.n(b);const z=flarum.reg.get("core","admin/utils/saveSettings");var O=e.n(z);const C=flarum.reg.get("core","admin/utils/getCategorizedExtensions");var j=e.n(C);const k=flarum.reg.get("core","admin/utils/isExtensionEnabled");var w=e.n(k);function N(){switch(a().data.settings["sycho-ace.selected-categorization"]){case"none":return function(){let e={};return e.none=Object.values(a().data.extensions),e}();case"vendor":return function(){let e={};return Object.keys(a().data.extensions).map((t=>{const n=t.split("-")[0];e[n]=e[n]||[],e[n].push(a().data.extensions[t])})),e}();case"availability":return function(){let e={enabled:[],disabled:[]};return Object.keys(a().data.extensions).map((t=>{const n=w()(t)?"enabled":"disabled";e[n].push(a().data.extensions[t])})),e}();default:return j()()}}function _(){switch(a().data.settings["sycho-ace.selected-categorization"]){case"none":return{none:0};case"vendor":return function(){let e={},t=[];Object.keys(a().data.extensions).map((e=>{t.push(e.split("-")[0])})),t.sort(((e,t)=>"flarum"===e?-1:e>t?1:e===t?0:-1));let n=10*t.length;return t.forEach((t=>e[t]=n-=10)),e.flarum&&(e.flarum=5e3),e}();case"availability":return{enabled:10,disabled:0};default:return a().extensionCategories}}function L(){let e={};const t=_();return Object.keys(t).map((t=>{switch(a().data.settings["sycho-ace.selected-categorization"]){case"default":e[t]=a().translator.trans("core.admin.nav.categories.".concat(t),{},!0);break;case"vendor":e[t]=t;break;default:e[t]=a().translator.trans("sycho-ace.admin.categories.".concat(t),{},!0)}})),e}function S(){return{default:a().translator.trans("sycho-ace.admin.category_selection.options.default",{},!0),vendor:a().translator.trans("sycho-ace.admin.category_selection.options.vendor",{},!0),availability:a().translator.trans("sycho-ace.admin.category_selection.options.availability",{},!0),none:a().translator.trans("sycho-ace.admin.category_selection.options.none",{},!0)}}flarum.reg.add("sycho-advanced-extension-categories","admin/utils/getCategorizedExtensions",N),flarum.reg.add("sycho-advanced-extension-categories","admin/utils/getCategories",_),flarum.reg.add("sycho-advanced-extension-categories","admin/utils/getCategoryLabels",L),flarum.reg.add("sycho-advanced-extension-categories","admin/utils/getCategorizationOptions",S);const W=flarum.reg.get("core","common/extenders"),A=[(new(e.n(W)().Admin)).setting((()=>({setting:"sycho-ace.selected-categorization",label:a().translator.trans("sycho-ace.admin.category_selection.label"),type:"select",options:S(),default:"default",refreshAfterSaving:!0})))];a().initializers.add("sycho-advanced-extension-categories",(e=>{const t=S();e.extensionCategories=_(),e.categorizedExtensions=N(),e.categoryLabels=L(),d().prototype.controlItems=function(){var n;const a=new(y()),o=null!=(n=e.data.settings["sycho-ace.selected-categorization"])?n:"default";return a.add("categorization",m("div",{className:"ExtensionsWidget-control-item"},m(h(),{buttonClassName:"Button",label:e.translator.trans("sycho-ace.admin.category_selection.label")},Object.keys(t).map((n=>m(x(),{icon:o!==n||"fas fa-check",active:o===n,onclick:()=>{O()({"sycho-ace.selected-categorization":n}).then((()=>window.location.reload())),e.modal.show(u())}},t[n])))))),a},(0,o.override)(d().prototype,"oninit",(function(){this.categorizedExtensions=e.categorizedExtensions})),(0,o.override)(d().prototype,"content",(function(t){return[m("div",{className:"ExtensionsWidget-list-heading"},m("h2",{className:"ExtensionsWidget-list-name"},m("span",{className:"ExtensionsWidget-list-icon"},m(E(),{name:"fas fa-puzzle-piece"})),m("span",{className:"ExtensionsWidget-list-title"},e.translator.trans("sycho-ace.admin.extensions"))),m("div",{className:"ExtensionsWidget-list-controls"},this.controlItems().toArray())),t()]})),(0,o.extend)(d().prototype,"extensionCategory",(function(t,n){t.children instanceof Array&&t.children[0]instanceof Object&&"children"in t.children[0]&&t.children[0].children instanceof Array&&t.children[0].children[0]instanceof Object&&"children"in t.children[0].children[0]&&(t.children[0].children[0].children=[e.categoryLabels[n]])})),(0,o.override)(r().prototype,"extensionItems",(function(){const t=new(y());return Object.keys(e.categorizedExtensions).map((n=>{this.query()||t.add("category-".concat(n),m("h4",{className:"ExtensionListTitle"},e.categoryLabels[n]),e.extensionCategories[n]),e.categorizedExtensions[n].map((a=>{var o;const s=this.query().toUpperCase(),r=a.extra["flarum-extension"].title;(!s||r.toUpperCase().includes(s)||null!=(o=a.description)&&o.toUpperCase().includes(s))&&t.add("extension-".concat(a.id),m(c(),{href:e.route("extension",{id:a.id}),extensionId:a.id,className:"ExtensionNavButton",title:a.description},r),e.extensionCategories[n])}))})),t}))}),-999)})(),module.exports=t})();
//# sourceMappingURL=admin.js.map